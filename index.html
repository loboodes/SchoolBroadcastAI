<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø°ÙƒÙŠ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        body { background-color: #f4fdf9; font-family: 'Segoe UI', Tahoma, sans-serif; }
        .prep-card { background: white; border-radius: 15px; border-top: 8px solid #198754; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .result-box { background: white; padding: 40px; border: 1px solid #eee; margin-top: 25px; line-height: 2; }
    </style>
</head>
<body>
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="prep-card text-center">
                <h2 class="mb-4 text-success">ğŸ“ Ù…Ø®Ø·Ø· Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ø°ÙƒÙŠ</h2>
                <input type="text" id="subject" class="form-control mb-3" placeholder="Ø§Ù„Ù…Ø§Ø¯Ø© (Ù…Ø«Ø§Ù„: Ø±ÙŠØ§Ø¶ÙŠØ§ØªØŒ ÙƒÙŠÙ…ÙŠØ§Ø¡)">
                <input type="text" id="lesson" class="form-control mb-4" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³">
                <button onclick="generatePlan()" id="btn" class="btn btn-success btn-lg w-100">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªØ­Ø¶ÙŠØ± Ø§Ù„ÙƒØ§Ù…Ù„</button>
            </div>
            
            <div id="outputContainer" class="d-none">
                <div id="printableArea" class="result-box">
                    <h3 id="head" class="text-center mb-4"></h3>
                    <div id="content" style="white-space: pre-wrap;"></div>
                </div>
                <button onclick="savePDF()" class="btn btn-dark btn-lg w-100 mt-3">ØªØ­Ù…ÙŠÙ„ ÙƒÙ…Ù„Ù PDF</button>
            </div>
        </div>
    </div>
</div>

<script type="module">
    const KEY = "AIzaSyA4JrK-4MnPur1nj9c5Se0gbQhyw_gSK18"; 
    const URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${KEY}`;

    window.generatePlan = async () => {
        const s = document.getElementById('subject').value;
        const l = document.getElementById('lesson').value;
        const btn = document.getElementById('btn');
        btn.disabled = true; btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¶ÙŠØ±...";

        const prompt = `ØµÙ…Ù… ØªØ­Ø¶ÙŠØ± Ø¯Ø±Ø³ Ø§Ø­ØªØ±Ø§ÙÙŠ Ù„Ù…Ø§Ø¯Ø© (${s}) Ø¹Ù†ÙˆØ§Ù†Ù‡ (${l}) ÙŠØ´Ù…Ù„ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø³Ù„ÙˆÙƒÙŠØ© Ø¨Ø£Ø³Ù„ÙˆØ¨ ØªØ±Ø¨ÙˆÙŠØŒ Ø§Ù„ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©ØŒ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ³ØŒ ÙˆØ®Ø§ØªÙ…Ø© ØªÙ‚ÙˆÙŠÙ…ÙŠØ©.`;

        try {
            const res = await fetch(URL, { method: "POST", body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] }) });
            const d = await res.json();
            document.getElementById('head').innerText = `ØªØ­Ø¶ÙŠØ± Ø¯Ø±Ø³: ${l}`;
            document.getElementById('content').innerText = d.candidates[0].content.parts[0].text;
            document.getElementById('outputContainer').classList.remove('d-none');
        } catch (e) { alert("ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª"); }
        finally { btn.disabled = false; btn.innerText = "ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªØ­Ø¶ÙŠØ± Ø§Ù„ÙƒØ§Ù…Ù„"; }
    };

    window.savePDF = () => {
        const element = document.getElementById('printableArea');
        html2pdf().from(element).save(`ØªØ­Ø¶ÙŠØ±_${document.getElementById('lesson').value}.pdf`);
    };
</script>
</body>
</html>
